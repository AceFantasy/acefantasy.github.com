<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />

<title>AceFantasyVI - 登陆</title>

<script type="text/javascript" src="http://lib.sinaapp.com/js/dojo/1.6.0/dojo.js"></script>
<script type="text/javascript" src="http://zouyesheng.sinaapp.com/static/js/constant.js"></script>
<script type="text/javascript" src="http://zouyesheng.sinaapp.com/static/js/blog.js"></script>
<script type="text/javascript" src="http://zouyesheng.sinaapp.com/static/js/main.js"></script>
<link href="http://zouyesheng.sinaapp.com/static/css/reset.css" type="text/css" rel="stylesheet" media="all"/>
<link href="http://zouyesheng.sinaapp.com/static/css/main.css" type="text/css" rel="stylesheet" media="all"/>

</head>
<body>
    <div class="block">
        <div class="main blog">
            <h1>登陆</h1>

            <label>邮箱：</label><input name="email" />　
            <label>密码：</label><input name="password" type="password"/>　
            <button id="login_btn" />提交</button>

        </div>
    </div>

<script type="text/javascript" charset="utf-8">
    dojo.addOnLoad(function(){
        //登陆
        (function(){
            dojo.connect(dojo.byId('login_btn'), 'onclick', function(eventObj){
                eventObj.target.blur();
                var email = dojo.attr(dojo.query('input[name="email"]')[0], 'value');
                var password = dojo.attr(dojo.query('input[name="password"]')[0], 'value');
                if(email == '' || password == ''){
                    return my_alert('邮箱和密码都不能为空');
                }
                var an = my_alert('正在提交...');
                dojo.xhrPost({
                    url: URL.login,
                    content:  {email: email, password: password},
                    handleAs: 'json',
                    an: an,
                    error: function(error, ioArgs){return my_alert(error.message)},
                    load: function(response, ioArgs){
                        ioArgs.args.an.destroy(0);
                        if(response.result != 0){
                            return my_alert('登陆出错了, ' + response.msg);
                        }
                        my_alert('登陆成功', -1);
                    }
                });
            });
        })();
    });
</script>
</body>
</html>
